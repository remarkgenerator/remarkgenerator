<!DOCTYPE html>
<html lang="bn">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ওয়ারিশন সনদ ফর্ম</title>
  <style>
    body{font-family: "Noto Sans Bengali", Arial, sans-serif;background:#f3f4f6;margin:0;padding:20px}
    .container{max-width:900px;margin:0 auto;background:#fff;padding:18px;border-radius:8px;box-shadow:0 2px 10px rgba(0,0,0,0.06)}
    header{text-align:center;margin-bottom:10px}
    header img{max-height:70px}
    h1{margin:6px 0;font-size:22px}
    .small{color:#666;font-size:13px}
    .row{margin-bottom:10px}
    label{display:block;font-weight:700;margin-bottom:6px}
    input[type=text], textarea, select {width:100%;padding:8px;border:1px solid #ddd;border-radius:4px;font-size:15px}
    button, .btn{background:#0b5ed7;color:#fff;padding:8px 12px;border:none;border-radius:6px;cursor:pointer}
    #heirsTable{width:100%;border-collapse:collapse;margin:10px 0}
    #heirsTable th,#heirsTable td{border:1px solid #e0e0e0;padding:6px;text-align:left}
    .row-inline{display:flex;gap:8px}
    .row-inline input{flex:1}
    .removeRow{background:#e74c3c;padding:4px 8px;border-radius:4px;border:none;color:#fff;cursor:pointer}
  </style>
</head>
<body>
  <div class="container">
    <header>
      <img id="logo" src="logo.png" alt="Logo" onerror="this.style.display='none'">
      <h1>ওয়ারিশন সনদ ফর্ম</h1>
      <p class="small">১. তথ্য দিন → ২. Submit → ৩. Telegram-এ যোগাযোগ করুন</p>
    </header>

    <main id="main-area">
      <form id="warishForm" method="post"
        action="https://script.google.com/macros/s/AKfycbycA3xZmPrAJ6FTWYwLtPWZFADjho099AvIZ3KLnumygXpRh6ZhxmjgN2dpHLcBxits/exec">

        <div class="row"><label>ফর্ম নাম</label><input name="formName" type="text" value="ওয়ারিশন সনদ" required></div>
        <div class="row"><label>ফর্ম নম্বর (ঐচ্ছিক)</label><input name="formNumber" type="text"></div>

        <h3>মৃত ব্যক্তির তথ্য</h3>
        <div class="row"><label>মৃত ব্যক্তির নাম</label><input name="deceasedName" type="text" required></div>
        <div class="row"><label>পিতা/স্বামী </label><input name="fatherName" type="text" required></div>
        <div class="row"><label>মহল্লা</label><input name="mohalla" type="text" required></div>
        <div class="row"><label>ওয়ার্ড নং</label><input name="postOffice" type="text" required></div>
        <div class="row"><label>ডাকঘর</label><input name="upazila" type="text" required></div>
        <div class="row"><label>উপজেলা/থানা</label><input name="thana" type="text" required></div>
        <div class="row"><label>জেলা</label><input name="ward" type="text" required></div>

        <h3>ওয়ারিশদের তালিকা</h3>
        <table id="heirsTable">
          <thead>
            <tr><th>ক্রমিক নং</th><th>নাম</th><th>বয়স</th><th>সম্পর্ক</th><th>মন্তব্য</th><th></th></tr>
          </thead>
          <tbody></tbody>
        </table>
        <button type="button" id="addHeirBtn" class="btn">+ ওয়ারিশ যোগ করুন</button>

        <!-- Hidden Inputs -->
        <input type="hidden" name="heirs" id="heirsInput" value="">
        <input type="hidden" name="clientRef" id="clientRef" value="">
        <input type="hidden" name="redirect" value="https://remarkgenerator.github.io/remarkgenerator/">

        <div class="row" style="margin-top:12px">
          <button type="submit" id="submitBtn">Submit</button>
        </div>
      </form>
    </main>
  </div>

  <script>
    function generateRef(){ 
      const t = Date.now().toString().slice(-6); 
      const r = Math.floor(Math.random()*9000)+1000; 
      return 'WF-'+t+'-'+r; 
    }

    function updateSerials(){
      const rows = document.querySelectorAll('#heirsTable tbody tr');
      rows.forEach((tr,i)=>{
        tr.querySelector('.serial').textContent = String(i+1).padStart(2,'0');
      });
    }

    function addHeirRow(name='', age='', rel='', note=''){
      const tbody = document.querySelector('#heirsTable tbody');
      const tr = document.createElement('tr');
      tr.innerHTML = `
        <td class="serial"></td>
        <td><input class="h-name" type="text" value="${(name||'').replace(/"/g,'&quot;')}"></td>
        <td><input class="h-age" type="text" value="${(age||'').replace(/"/g,'&quot;')}"></td>
        <td><input class="h-rel" type="text" value="${(rel||'').replace(/"/g,'&quot;')}"></td>
        <td><input class="h-note" type="text" value="${(note||'').replace(/"/g,'&quot;')}"></td>
        <td><button type="button" class="removeRow">Remove</button></td>`;
      tbody.appendChild(tr);
      tr.querySelector('.removeRow').addEventListener('click', ()=> { tr.remove(); updateSerials(); });
      updateSerials();
    }

    document.addEventListener('DOMContentLoaded', ()=>{
      const form = document.getElementById('warishForm');
      const addBtn = document.getElementById('addHeirBtn');
      addHeirRow();

      addBtn.addEventListener('click', ()=> addHeirRow());

      form.addEventListener('submit', function(e){
        // ওয়ারিশ ডেটা Hidden Input-এ বসানো
        const heirs = [];
        document.querySelectorAll('#heirsTable tbody tr').forEach(tr=>{
          const name = tr.querySelector('.h-name').value.trim();
          const age = tr.querySelector('.h-age').value.trim();
          const rel = tr.querySelector('.h-rel').value.trim();
          const note = tr.querySelector('.h-note').value.trim();
          if(name) heirs.push({name, age, rel, note});
        });
        document.getElementById('heirsInput').value = JSON.stringify(heirs);

        // রেফারেন্স কোড Hidden Input-এ বসানো
        const ref = generateRef();
        document.getElementById('clientRef').value = ref;
      });
    });
  </script>
</body>
</html>
