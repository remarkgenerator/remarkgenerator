<!DOCTYPE html>
<html lang="bn">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>‡¶ì‡ßü‡¶æ‡¶∞‡¶ø‡¶∂‡¶® ‡¶∏‡¶®‡¶¶ ‚Äî Auto PDF</title>

  <!-- Bengali Font -->
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Bengali&display=swap" rel="stylesheet" />

  <!-- html2pdf.js CDN -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

  <style>
    body {
      font-family: "Noto Sans Bengali", Arial, sans-serif;
      background: #f3f4f6;
      margin: 0;
      padding: 20px;
      color: #222;
      line-height: 1.4;
      font-size: 15px;
    }
    .container {
      max-width: 900px;
      margin: 0 auto;
      background: #fff;
      padding: 25px 30px 30px;
      border-radius: 10px;
      box-shadow: 0 2px 12px rgba(0, 0, 0, 0.07);
    }
    header {
      text-align: center;
      margin-bottom: 20px;
    }
    header img {
      max-height: 70px;
      margin-bottom: 8px;
    }
    h1 {
      margin: 6px 0 6px;
      font-size: 24px;
      font-weight: 700;
      color: #0b5ed7;
    }
    .small {
      color: #666;
      font-size: 13px;
      font-weight: 500;
    }
    h3 {
      margin-top: 25px;
      margin-bottom: 10px;
      font-weight: 700;
      color: #0b5ed7;
      border-bottom: 2px solid #0b5ed7;
      padding-bottom: 4px;
      font-size: 18px;
    }
    .row {
      margin-bottom: 14px;
    }
    label {
      display: block;
      font-weight: 600;
      margin-bottom: 6px;
      font-size: 15px;
    }
    input[type=text], textarea, select {
      width: 100%;
      padding: 10px 12px;
      border: 1.8px solid #cbd5e1;
      border-radius: 6px;
      font-size: 15px;
      font-family: "Noto Sans Bengali", Arial, sans-serif;
      box-sizing: border-box;
      transition: border-color 0.3s ease;
    }
    input[type=text]:focus, textarea:focus, select:focus {
      outline: none;
      border-color: #0b5ed7;
      box-shadow: 0 0 8px rgba(11, 94, 215, 0.3);
    }
    button, .btn {
      background: #0b5ed7;
      color: #fff;
      padding: 10px 16px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 700;
      font-size: 15px;
      transition: background-color 0.3s ease;
      user-select: none;
    }
    button:hover:not(:disabled), .btn:hover:not(:disabled) {
      background-color: #084abf;
    }
    button:disabled, .btn:disabled {
      background-color: #a1a7b3 !important;
      cursor: not-allowed;
    }
    #heirsTable {
      width: 100%;
      border-collapse: collapse;
      margin: 12px 0 14px;
      font-size: 14px;
      table-layout: fixed;
    }
    #heirsTable th, #heirsTable td {
      border: 1.5px solid #e0e0e0;
      padding: 8px 10px;
      text-align: left;
      vertical-align: middle;
      word-wrap: break-word;
    }
    #heirsTable th {
      background-color: #f0f6ff;
      font-weight: 700;
      color: #0b5ed7;
    }
    .row-inline {
      display: flex;
      gap: 10px;
    }
    .row-inline input {
      flex: 1;
      padding: 10px 12px;
      font-size: 15px;
    }
    .removeRow {
      background: #e74c3c;
      padding: 6px 12px;
      border-radius: 6px;
      border: none;
      color: #fff;
      cursor: pointer;
      font-weight: 700;
      font-size: 13px;
      transition: background-color 0.3s ease;
    }
    .removeRow:hover {
      background-color: #c0392b;
    }
    .muted {
      color: #666;
      font-size: 13px;
    }
    #note {
      font-size: 13px;
      color: #444;
      margin-top: 10px;
      font-style: italic;
    }

    /* Responsive */
    @media (max-width: 600px) {
      .row-inline {
        flex-direction: column;
      }
      #heirsTable th, #heirsTable td {
        font-size: 13px;
        padding: 6px 8px;
      }
      button, .btn {
        width: 100%;
      }
    }

    /* PDF Layout */
    #pdfContent {
      font-family: "Noto Sans Bengali", Arial, sans-serif;
      padding: 20px;
      color: #222;
    }
    #pdfContent h1, #pdfContent h3 {
      color: #0b5ed7;
    }
    #pdfContent table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 10px;
      margin-bottom: 20px;
    }
    #pdfContent table, #pdfContent th, #pdfContent td {
      border: 1px solid #333;
    }
    #pdfContent th, #pdfContent td {
      padding: 6px 8px;
      text-align: left;
    }

    /* Popup overlay */
    #popupOverlay, #refCodePopup, #telegramContactPopup {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: white;
      padding: 25px 30px;
      border-radius: 10px;
      max-width: 450px;
      width: 100%;
      box-shadow: 0 2px 12px rgba(0,0,0,0.3);
      text-align: center;
      font-size: 15px;
      color: #222;
      display: none;
    }

    #popup h2, #refCodePopup h2, #telegramContactPopup h2 {
      font-weight: 700;
      color: #dc3545;
    }

    /* Invalid/Valid input styling */
    input#contactRefCodeInput {
      border: 2px solid #ccc;
      padding: 10px;
      border-radius: 6px;
      font-size: 16px;
      width: 100%;
      box-sizing: border-box;
      transition: border 0.3s ease;
    }

    input#contactRefCodeInput.invalid {
      border: 2px solid red;
      box-shadow: 0 0 8px rgba(255, 0, 0, 0.5);
    }

    input#contactRefCodeInput.valid {
      border: 2px solid green;
      box-shadow: 0 0 8px rgba(0, 255, 0, 0.5);
    }

  </style>
</head>
<body>
  <div class="container">
    <header>
      <img id="logo" src="logo.png" alt="Logo" onerror="this.style.display='none'">
      <h1>‡¶ì‡ßü‡¶æ‡¶∞‡¶ø‡¶∂‡¶® ‡¶∏‡¶®‡¶¶ ‡¶´‡¶∞‡ßç‡¶Æ</h1>
      <p class="small">‡¶§‡¶•‡ßç‡¶Ø ‡¶™‡ßÇ‡¶∞‡¶£ ‡¶ï‡¶∞‡ßá Submit ‡¶¶‡¶ø‡¶≤‡ßá Demo PDF ‡¶∏‡ßç‡¶¨‡¶Ø‡¶º‡¶Ç‡¶ï‡ßç‡¶∞‡¶ø‡¶Ø‡¶º‡¶≠‡¶æ‡¶¨‡ßá ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶° ‡¶π‡¶¨‡ßá ‡¶§‡¶¨‡ßá ‡¶Ö‡¶´‡¶ø‡¶ú‡¶ø‡¶®‡¶æ‡¶≤ PDF ‡¶™‡ßá‡¶§‡ßá ‡¶Ö‡¶¨‡¶∂‡¶á ‡¶ü‡ßá‡¶≤‡¶ø‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ ‡¶è ‡¶§‡¶•‡ßç‡¶Ø ‡¶™‡¶æ‡¶†‡¶æ‡¶® ‡¶¨‡¶æ‡¶ü‡¶® ‡¶è ‡¶ö‡¶æ‡¶™ ‡¶¶‡ßá‡¶¨‡¶æ‡¶∞ ‡¶™‡¶∞ Admin ‡¶è‡¶∞ ‡¶∏‡¶æ‡¶•‡ßá ‡¶Ø‡ßã‡¶ó‡¶æ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡¶§‡ßá ‡¶π‡¶¨‡ßá</p>
    </header>

    <main id="main-area">
      <form id="warishForm" autocomplete="off" novalidate>
        <div class="row">
          <label for="formName">‡¶´‡¶∞‡ßç‡¶Æ ‡¶®‡¶æ‡¶Æ</label>
          <input id="formName" name="formName" type="text" required placeholder="‡¶¨‡¶ø‡¶≠‡¶æ‡¶ó ‡¶ú‡ßá‡¶≤‡¶æ ‡¶â‡¶™‡¶ú‡ßá‡¶≤‡¶æ ‡¶è‡¶¨‡¶Ç ‡¶™‡ßå‡¶∞‡¶∏‡¶≠‡¶æ‡¶∞ ‡¶®‡¶æ‡¶Æ ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®">
        </div>
        <div class="row">
          <label for="formNumber">‡¶´‡¶∞‡ßç‡¶Æ ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞ (‡¶ê‡¶ö‡ßç‡¶õ‡¶ø‡¶ï)</label>
          <input id="formNumber" name="formNumber" type="text" placeholder="‡¶Ø‡ßá‡¶Æ‡¶®: ‡ßß‡ß®‡ß©‡ß™‡ß´‡ß¨">
        </div>

        <h3>‡¶Æ‡ßÉ‡¶§ ‡¶¨‡ßç‡¶Ø‡¶ï‡ßç‡¶§‡¶ø‡¶∞ ‡¶§‡¶•‡ßç‡¶Ø</h3>
        <div class="row">
          <label for="deceasedName">‡¶Æ‡ßÉ‡¶§ ‡¶¨‡ßç‡¶Ø‡¶ï‡ßç‡¶§‡¶ø‡¶∞ ‡¶®‡¶æ‡¶Æ</label>
          <input id="deceasedName" name="deceasedName" type="text" required placeholder="‡¶Æ‡ßÉ‡¶§ ‡¶¨‡ßç‡¶Ø‡¶ï‡ßç‡¶§‡¶ø‡¶∞ ‡¶∏‡¶Æ‡ßç‡¶™‡ßÇ‡¶∞‡ßç‡¶£ ‡¶®‡¶æ‡¶Æ">
        </div>
        <div class="row">
          <label for="fatherName">‡¶™‡¶ø‡¶§‡¶æ/‡¶∏‡ßç‡¶¨‡¶æ‡¶Æ‡ßÄ</label>
          <input id="fatherName" name="fatherName" type="text" required placeholder="‡¶™‡¶ø‡¶§‡¶æ ‡¶Ö‡¶•‡¶¨‡¶æ ‡¶∏‡ßç‡¶¨‡¶æ‡¶Æ‡ßÄ‡¶∞ ‡¶®‡¶æ‡¶Æ">
        </div>
        <div class="row">
          <label for="mohalla">‡¶Æ‡¶π‡¶≤‡ßç‡¶≤‡¶æ</label>
          <input id="mohalla" name="mohalla" type="text" required placeholder="‡¶Æ‡¶π‡¶≤‡ßç‡¶≤‡¶æ‡¶∞ ‡¶®‡¶æ‡¶Æ">
        </div>
        <div class="row">
          <label for="ward">‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶° ‡¶®‡¶Ç</label>
          <input id="ward" name="ward" type="text" required placeholder="‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶° ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞">
        </div>
        <div class="row">
          <label for="postOffice">‡¶°‡¶æ‡¶ï‡¶ò‡¶∞</label>
          <input id="postOffice" name="postOffice" type="text" required placeholder="‡¶°‡¶æ‡¶ï‡¶ò‡¶∞‡ßá‡¶∞ ‡¶®‡¶æ‡¶Æ">
        </div>
        <div class="row">
          <label for="thana">‡¶â‡¶™‡¶ú‡ßá‡¶≤‡¶æ/‡¶•‡¶æ‡¶®‡¶æ</label>
          <input id="thana" name="thana" type="text" required placeholder="‡¶â‡¶™‡¶ú‡ßá‡¶≤‡¶æ ‡¶¨‡¶æ ‡¶•‡¶æ‡¶®‡¶æ">
        </div>
        <div class="row">
          <label for="district">‡¶ú‡ßá‡¶≤‡¶æ</label>
          <input id="district" name="district" type="text" required placeholder="‡¶ú‡ßá‡¶≤‡¶æ‡¶∞ ‡¶®‡¶æ‡¶Æ">
        </div>

        <h3>‡¶ì‡ßü‡¶æ‡¶∞‡¶ø‡¶∂‡¶¶‡ßá‡¶∞ ‡¶§‡¶æ‡¶≤‡¶ø‡¶ï‡¶æ</h3>
        <table id="heirsTable" aria-label="‡¶ì‡ßü‡¶æ‡¶∞‡¶ø‡¶∂‡¶¶‡ßá‡¶∞ ‡¶§‡¶•‡ßç‡¶Ø‡ßá‡¶∞ ‡¶§‡¶æ‡¶≤‡¶ø‡¶ï‡¶æ">
          <thead>
            <tr>
              <th style="width: 5%;">‡¶ï‡ßç‡¶∞‡¶Æ‡¶ø‡¶ï</th>
              <th style="width: 30%;">‡¶®‡¶æ‡¶Æ</th>
              <th style="width: 15%;">‡¶¨‡¶Ø‡¶º‡¶∏</th>
              <th style="width: 25%;">‡¶∏‡¶Æ‡ßç‡¶™‡¶∞‡ßç‡¶ï</th>
              <th style="width: 20%;">‡¶Æ‡¶®‡ßç‡¶§‡¶¨‡ßç‡¶Ø (‡¶ê‡¶ö‡ßç‡¶õ‡¶ø‡¶ï)</th>
              <th style="width: 5%;">#</th>
            </tr>
          </thead>
          <tbody id="heirsBody">
            <tr>
              <td class="serial">‡ßß</td>
              <td><input type="text" name="heirName[]" required placeholder="‡¶®‡¶æ‡¶Æ ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®"></td>
              <td><input type="text" name="age[]" required placeholder="‡¶¨‡¶Ø‡¶º‡¶∏"></td>
              <td><input type="text" name="relation[]" required placeholder="‡¶∏‡¶Æ‡ßç‡¶™‡¶∞‡ßç‡¶ï"></td>
              <td><input type="text" name="comment[]" placeholder="‡¶Æ‡¶®‡ßç‡¶§‡¶¨‡ßç‡¶Ø"></td>
              <td><button type="button" class="removeRow" aria-label="‡¶∏‡¶æ‡¶∞‡¶ø ‡¶Æ‡ßÅ‡¶õ‡ßÅ‡¶®">&times;</button></td>
            </tr>
          </tbody>
        </table>
        <button type="button" id="addHeir" class="btn" aria-label="‡¶®‡¶§‡ßÅ‡¶® ‡¶ì‡ßü‡¶æ‡¶∞‡¶ø‡¶∂ ‡¶Ø‡ßÅ‡¶ï‡ßç‡¶§ ‡¶ï‡¶∞‡ßÅ‡¶®">+ ‡¶®‡¶§‡ßÅ‡¶® ‡¶ì‡ßü‡¶æ‡¶∞‡¶ø‡¶∂ ‡¶Ø‡ßÅ‡¶ï‡ßç‡¶§ ‡¶ï‡¶∞‡ßÅ‡¶®</button>

        <div class="row" style="margin-top: 20px; display: flex; gap: 15px; flex-wrap: wrap;">
          <button type="submit" id="generatePdfBtn" class="btn" aria-label="‡¶™‡¶ø‡¶°‡¶ø‡¶è‡¶´ ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡ßÅ‡¶®">‡¶™‡¶ø‡¶°‡¶ø‡¶è‡¶´ ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡ßÅ‡¶®</button>
          <button type="button" id="sendTelegramBtn" class="btn" aria-label="‡¶ü‡ßá‡¶≤‡¶ø‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ‡ßá‡¶∞ ‡¶§‡¶•‡ßç‡¶Ø ‡¶™‡¶æ‡¶†‡¶æ‡¶®" disabled>‡¶ü‡ßá‡¶≤‡¶ø‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ‡ßá‡¶∞ ‡¶§‡¶•‡ßç‡¶Ø ‡¶™‡¶æ‡¶†‡¶æ‡¶®</button>
          <button type="button" id="contactTelegramBtn" class="btn" aria-label="‡¶ü‡ßá‡¶≤‡¶ø‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ‡ßá ‡¶Ø‡ßã‡¶ó‡¶æ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡ßÅ‡¶®">‡¶ü‡ßá‡¶≤‡¶ø‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ‡ßá ‡¶Ø‡ßã‡¶ó‡¶æ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡ßÅ‡¶®</button>
        </div>
      </form>
    </main>
  </div>

  <!-- Popup Overlay -->
  <div id="popupOverlay" role="dialog" aria-modal="true" aria-labelledby="popupTitle" aria-describedby="popupDesc">
    <div id="popup">
      <h2 id="popupTitle">‚ö†Ô∏è ‡¶∏‡¶§‡¶∞‡ßç‡¶ï‡¶§‡¶æ</h2>
      <p id="popupDesc">
        ‡¶Ö‡¶®‡ßÅ‡¶ó‡ßç‡¶∞‡¶π ‡¶ï‡¶∞‡ßá ‡¶®‡¶ø‡¶∂‡ßç‡¶ö‡¶ø‡¶§ ‡¶ï‡¶∞‡ßÅ‡¶® ‡¶Ø‡ßá ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶∏‡¶ï‡¶≤ ‡¶§‡¶•‡ßç‡¶Ø ‡¶∏‡¶†‡¶ø‡¶ï‡¶≠‡¶æ‡¶¨‡ßá ‡¶™‡ßÇ‡¶∞‡¶£ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá‡•§ ‡¶∏‡¶æ‡¶¨‡¶Æ‡¶ø‡¶ü ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶™‡¶∞ ‡¶§‡¶•‡ßç‡¶Ø ‡¶∏‡¶Æ‡ßç‡¶™‡¶æ‡¶¶‡¶®‡¶æ‡¶∞ ‡¶∏‡ßÅ‡¶Ø‡ßã‡¶ó ‡¶•‡¶æ‡¶ï‡¶¨‡ßá ‡¶®‡¶æ‡•§ ‡¶§‡¶æ‡¶á ‡¶∏‡¶æ‡¶¨‡¶Æ‡¶ø‡¶ü ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶™‡ßÇ‡¶∞‡ßç‡¶¨‡ßá ‡¶§‡¶•‡ßç‡¶Ø‡¶ó‡ßÅ‡¶≤‡¶ø ‡¶™‡ßÅ‡¶®‡¶∞‡¶æ‡¶Ø‡¶º ‡¶Ø‡¶æ‡¶ö‡¶æ‡¶á ‡¶ï‡¶∞‡ßá ‡¶®‡¶ø‡¶∂‡ßç‡¶ö‡¶ø‡¶§ ‡¶π‡¶Ø‡¶º‡ßá ‡¶∏‡¶æ‡¶¨‡¶Æ‡¶ø‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®‡•§<br>
        <strong> ‡¶®‡¶ø‡¶Ø‡¶º‡¶Æ‡¶∏‡¶Æ‡ßÇ‡¶π:</strong>
        <ul>
          <li>‡¶™‡¶ø‡¶°‡¶ø‡¶è‡¶´ ‡¶ú‡ßá‡¶®‡¶æ‡¶∞‡ßá‡¶ü ‡¶¨‡¶æ‡¶ü‡¶®‡ßá ‡¶ö‡¶æ‡¶™ ‡¶¶‡¶ø‡¶≤‡ßá ‡¶∏‡¶∞‡¶æ‡¶∏‡¶∞‡¶ø ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶™‡¶ø‡¶°‡¶ø‡¶è‡¶´ ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶° ‡¶π‡¶Ø‡¶º‡ßá ‡¶Ø‡¶æ‡¶¨‡ßá‡•§</li>
          <li>‡¶™‡¶ø‡¶°‡¶ø‡¶è‡¶´ ‡¶ú‡ßá‡¶®‡¶æ‡¶∞‡ßá‡¶ü ‡¶π‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶™‡¶∞ ‡¶Ö‡¶®‡ßÅ‡¶ó‡ßç‡¶∞‡¶π ‡¶ï‡¶∞‡ßá ‡¶ü‡ßá‡¶≤‡¶ø‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ‡ßá‡¶∞ ‡¶§‡¶•‡ßç‡¶Ø ‡¶™‡¶æ‡¶†‡¶æ‡¶® ‡¶¨‡¶æ‡¶ü‡¶®‡ßá ‡¶ö‡¶æ‡¶™ ‡¶¶‡¶ø‡¶®‡•§</li>
          <li>‡¶ü‡ßá‡¶≤‡¶ø‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ‡ßá‡¶∞ ‡¶§‡¶•‡ßç‡¶Ø ‡¶∏‡¶´‡¶≤‡¶≠‡¶æ‡¶¨‡ßá ‡¶™‡¶æ‡¶†‡¶æ‡¶®‡ßã ‡¶π‡¶≤‡ßá, ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶∞‡ßá‡¶´‡¶æ‡¶∞‡ßá‡¶®‡ßç‡¶∏ ‡¶ï‡ßã‡¶°‡¶∏‡¶π ‡¶∏‡¶∞‡¶æ‡¶∏‡¶∞‡¶ø ‡¶è‡¶°‡¶Æ‡¶ø‡¶®‡ßá‡¶∞ ‡¶∏‡¶æ‡¶•‡ßá ‡¶Ø‡ßã‡¶ó‡¶æ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡¶§‡ßá ‡¶ü‡ßá‡¶≤‡¶ø‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ‡ßá‡¶∞ ‡¶Ø‡ßã‡¶ó‡¶æ‡¶Ø‡ßã‡¶ó ‡¶¨‡¶æ‡¶ü‡¶®‡ßá ‡¶ö‡¶æ‡¶™ ‡¶¶‡¶ø‡¶®‡•§</li>
        </ul>
      </p>
      <p>‡¶∏‡¶æ‡¶¨‡¶Æ‡¶ø‡¶ü ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶Ö‡¶™‡ßá‡¶ï‡ßç‡¶∑‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶® <span id="timer">10</span> ‡¶∏‡ßá‡¶ï‡ßá‡¶®‡ßç‡¶°</p>
      <button id="confirmSubmitBtn" disabled>‡¶Ü‡¶Æ‡¶ø ‡¶®‡¶ø‡¶∂‡ßç‡¶ö‡¶ø‡¶§, ‡¶∏‡¶æ‡¶¨‡¶Æ‡¶ø‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®</button>
      <button id="cancelSubmitBtn" style="margin-left:10px; background:#6c757d;">‡¶¨‡¶æ‡¶§‡¶ø‡¶≤ ‡¶ï‡¶∞‡ßÅ‡¶®</button>
    </div>
  </div>

  <!-- Reference code popup -->
  <div id="refCodePopup" role="dialog" aria-modal="true" aria-labelledby="refCodeTitle" aria-describedby="refCodeDesc" style="display:none;">
    <div id="popup" style="max-width: 400px;">
      <h2 id="refCodeTitle">‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶∞‡ßá‡¶´‡¶æ‡¶∞‡ßá‡¶®‡ßç‡¶∏ ‡¶ï‡ßã‡¶°</h2>
      <div id="referenceCodeText" tabindex="0" role="textbox" aria-readonly="true"></div>
      <button id="copyRefCodeBtn" class="btn" style="margin-top:5px;">‡¶ï‡¶™‡¶ø ‡¶ï‡¶∞‡ßÅ‡¶®</button>
      <p id="copyMsg" style="display: none;">‡¶ï‡¶™‡¶ø ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá!</p>
      <button id="closeRefCodePopup" class="btn" style="margin-top:15px;">‡¶¨‡¶®‡ßç‡¶ß ‡¶ï‡¶∞‡ßÅ‡¶®</button>
    </div>
  </div>

  <!-- Telegram Contact popup -->
  <div id="telegramContactPopup" role="dialog" aria-modal="true" aria-labelledby="contactTitle" aria-describedby="contactDesc" style="display:none;">
    <div id="popup" style="max-width: 400px;">
      <h2 id="contactTitle">‡¶ü‡ßá‡¶≤‡¶ø‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ‡ßá ‡¶Ø‡ßã‡¶ó‡¶æ‡¶Ø‡ßã‡¶ó</h2>
      <p id="contactDesc">‡¶∞‡ßá‡¶´‡¶æ‡¶∞‡ßá‡¶®‡ßç‡¶∏ ‡¶ï‡ßã‡¶° ‡¶¶‡¶ø‡¶® ‡¶Ø‡ßá‡¶ü‡¶æ ‡¶¶‡¶ø‡¶Ø‡¶º‡ßá ‡¶Ü‡¶™‡¶®‡¶ø ‡¶´‡¶∞‡ßç‡¶Æ ‡¶∏‡¶æ‡¶¨‡¶Æ‡¶ø‡¶ü ‡¶ï‡¶∞‡ßá‡¶õ‡ßá‡¶®:</p>
      <input type="text" id="contactRefCodeInput" placeholder="‡¶∞‡ßá‡¶´‡¶æ‡¶∞‡ßá‡¶®‡ßç‡¶∏ ‡¶ï‡ßã‡¶° ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®" style="width:100%; padding:8px; margin-bottom:10px; font-size:16px; box-sizing: border-box;" />
      <span id="refCodeValidIcon" aria-hidden="true" style="font-size: 24px; vertical-align: middle; margin-left: 6px;"></span>
      <p id="contactErrorMsg" style="color:red; display:none; font-weight:700;">‡¶∞‡ßá‡¶´‡¶æ‡¶∞‡ßá‡¶®‡ßç‡¶∏ ‡¶ï‡ßã‡¶° ‡¶≠‡ßÅ‡¶≤‡•§ ‡¶Ö‡¶®‡ßÅ‡¶ó‡ßç‡¶∞‡¶π ‡¶ï‡¶∞‡ßá ‡¶∏‡¶†‡¶ø‡¶ï ‡¶ï‡ßã‡¶° ‡¶¶‡¶ø‡¶®‡•§</p>
      <button id="contactConfirmBtn" class="btn">‡¶Ø‡ßã‡¶ó‡¶æ‡¶Ø‡ßã‡¶ó ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶ï‡¶∞‡ßÅ‡¶®</button>
      <button id="contactCancelBtn" class="btn" style="margin-top:10px; background:#6c757d;">‡¶¨‡¶æ‡¶§‡¶ø‡¶≤ ‡¶ï‡¶∞‡ßÅ‡¶®</button>
    </div>
  </div>

  <script>
    // --- Telegram bot config --- 
    const TELEGRAM_BOT_TOKEN = '8289822977:AAHXfya0wathSqLG2x1Xsrv-nR4ECZFhrZ0'; 
    const TELEGRAM_CHAT_ID = '8402648058'; 
    const TELEGRAM_USERNAME = 'remarkgenerator';

    // Helper: ‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ ‡¶∏‡¶Ç‡¶ñ‡ßç‡¶Ø‡¶æ ‡¶∞‡ßÇ‡¶™‡¶æ‡¶®‡ßç‡¶§‡¶∞ (1 -> ‡ßß)
    function toBanglaNumber(num) {
      const banglaDigits = ['‡ß¶','‡ßß','‡ß®','‡ß©','‡ß™','‡ß´','‡ß¨','‡ß≠','‡ßÆ','‡ßØ'];
      return num.toString().split('').map(d => banglaDigits[d] || d).join('');
    }

    // ‡¶∏‡¶ø‡¶∞‡¶ø‡ßü‡¶æ‡¶≤ ‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®
    function updateSerials() {
      const serialCells = document.querySelectorAll('#heirsBody .serial');
      serialCells.forEach((cell, i) => {
        cell.textContent = toBanglaNumber(i + 1);
      });
    }

    // Initialize heirs table serial and remove button events
    function initHeirsTable() {
      updateSerials();

      // Add remove event delegation
      document.getElementById('heirsBody').addEventListener('click', e => {
        if (e.target.classList.contains('removeRow')) {
          const tbody = document.getElementById('heirsBody');
          // Minimum 1 heir row must remain
          if (tbody.rows.length > 1) {
            e.target.closest('tr').remove();
            updateSerials();
          } else {
            alert('‡¶ï‡¶Æ‡¶™‡¶ï‡ßç‡¶∑‡ßá ‡¶è‡¶ï‡¶ü‡¶ø ‡¶ì‡ßü‡¶æ‡¶∞‡¶ø‡¶∂ ‡¶•‡¶æ‡¶ï‡¶æ ‡¶¨‡¶æ‡¶ß‡ßç‡¶Ø‡¶§‡¶æ‡¶Æ‡ßÇ‡¶≤‡¶ï‡•§');
          }
        }
      });
    }

    // Add new heir row
    document.getElementById('addHeir').addEventListener('click', () => {
      const tbody = document.getElementById('heirsBody');
      const newRow = document.createElement('tr');
      newRow.innerHTML = `
        <td class="serial"></td>
        <td><input type="text" name="heirName[]" required placeholder="‡¶®‡¶æ‡¶Æ ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®"></td>
        <td><input type="text" name="age[]" required placeholder="‡¶¨‡¶Ø‡¶º‡¶∏"></td>
        <td><input type="text" name="relation[]" required placeholder="‡¶∏‡¶Æ‡ßç‡¶™‡¶∞‡ßç‡¶ï"></td>
        <td><input type="text" name="comment[]" placeholder="‡¶Æ‡¶®‡ßç‡¶§‡¶¨‡ßç‡¶Ø"></td>
        <td><button type="button" class="removeRow" aria-label="‡¶∏‡¶æ‡¶∞‡¶ø ‡¶Æ‡ßÅ‡¶õ‡ßÅ‡¶®">&times;</button></td>
      `;
      tbody.appendChild(newRow);
      updateSerials();
    });

    // Generate random 8-char reference code (caps + digits)
    function generateReferenceCode() {
      const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
      let code = '';
      for (let i = 0; i < 8; i++) {
        code += chars.charAt(Math.floor(Math.random() * chars.length));
      }
      return code;
    }

    // Show popup overlay (confirm submit)
    const popupOverlay = document.getElementById('popupOverlay');
    const confirmSubmitBtn = document.getElementById('confirmSubmitBtn');
    const cancelSubmitBtn = document.getElementById('cancelSubmitBtn');
    const timerSpan = document.getElementById('timer');
    let countdownInterval;

    // Reference code popup elements
    const refCodePopup = document.getElementById('refCodePopup');
    const referenceCodeText = document.getElementById('referenceCodeText');
    const copyRefCodeBtn = document.getElementById('copyRefCodeBtn');
    const copyMsg = document.getElementById('copyMsg');
    const closeRefCodePopup = document.getElementById('closeRefCodePopup');

    // Telegram contact popup elements
    const telegramContactPopup = document.getElementById('telegramContactPopup');
    const contactRefCodeInput = document.getElementById('contactRefCodeInput');
    const refCodeValidIcon = document.getElementById('refCodeValidIcon');
    const contactConfirmBtn = document.getElementById('contactConfirmBtn');
    const contactCancelBtn = document.getElementById('contactCancelBtn');
    const contactErrorMsg = document.getElementById('contactErrorMsg');

    // Store reference code globally after PDF gen
    let currentReferenceCode = '';

    // Countdown function before enabling confirm button
    function startCountdown(seconds = 10) {
      let count = seconds;
      timerSpan.textContent = toBanglaNumber(count);
      confirmSubmitBtn.disabled = true;
      countdownInterval = setInterval(() => {
        count--;
        timerSpan.textContent = toBanglaNumber(count);
        if (count <= 0) {
          clearInterval(countdownInterval);
          confirmSubmitBtn.disabled = false;
          timerSpan.textContent = '';
        }
      }, 1000);
    }

    // Copy reference code text to clipboard
    copyRefCodeBtn.addEventListener('click', () => {
      navigator.clipboard.writeText(currentReferenceCode).then(() => {
        copyMsg.style.display = 'block';
        setTimeout(() => { copyMsg.style.display = 'none'; }, 1500);
      }).catch(() => {
        alert('‡¶¶‡ßÅ‡¶É‡¶ñ‡¶ø‡¶§, ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶≠‡ßá‡¶∞‡¶ø‡¶´‡¶ø‡¶ï‡ßá‡¶∂‡¶® ‡¶ï‡ßã‡¶° ‡¶ï‡¶™‡¶ø ‡¶ï‡¶∞‡¶§‡ßá ‡¶¨‡ßç‡¶Ø‡¶∞‡ßç‡¶• ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá‡•§ ‡¶Ö‡¶®‡ßÅ‡¶ó‡ßç‡¶∞‡¶π ‡¶ï‡¶∞‡ßá ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶®‡ßÅ‡¶Ø‡¶º‡¶æ‡¶≤‡¶ø ‡¶∏‡¶ø‡¶≤‡ßá‡¶ï‡ßç‡¶ü ‡¶ï‡¶∞‡ßá ‡¶ï‡¶™‡¶ø ‡¶ï‡¶∞‡ßÅ‡¶®');
      });
    });

    // Also allow clicking code text to copy
    referenceCodeText.addEventListener('click', () => {
      navigator.clipboard.writeText(currentReferenceCode).then(() => {
        copyMsg.style.display = 'block';
        setTimeout(() => { copyMsg.style.display = 'none'; }, 1500);
      }).catch(() => {
        alert('‡¶¶‡ßÅ‡¶É‡¶ñ‡¶ø‡¶§, ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶≠‡ßá‡¶∞‡¶ø‡¶´‡¶ø‡¶ï‡ßá‡¶∂‡¶® ‡¶ï‡ßã‡¶° ‡¶ï‡¶™‡¶ø ‡¶ï‡¶∞‡¶§‡ßá ‡¶¨‡ßç‡¶Ø‡¶∞‡ßç‡¶• ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá‡•§ ‡¶Ö‡¶®‡ßÅ‡¶ó‡ßç‡¶∞‡¶π ‡¶ï‡¶∞‡ßá ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶®‡ßÅ‡¶Ø‡¶º‡¶æ‡¶≤‡¶ø ‡¶∏‡¶ø‡¶≤‡ßá‡¶ï‡ßç‡¶ü ‡¶ï‡¶∞‡ßá ‡¶ï‡¶™‡¶ø ‡¶ï‡¶∞‡ßÅ‡¶®');
      });
    });

    closeRefCodePopup.addEventListener('click', () => {
      refCodePopup.style.display = 'none';
    });

    // Form submit event ‚Äî show countdown popup
    document.getElementById('warishForm').addEventListener('submit', e => {
      e.preventDefault();

      // Basic HTML5 validation
      if (!e.target.checkValidity()) {
        e.target.reportValidity();
        return;
      }

      popupOverlay.style.display = 'flex';
      startCountdown(10);
    });

    cancelSubmitBtn.addEventListener('click', () => {
      clearInterval(countdownInterval);
      popupOverlay.style.display = 'none';
    });

    // Confirm submit after countdown
    confirmSubmitBtn.addEventListener('click', () => {
      popupOverlay.style.display = 'none';

      // Generate reference code and save globally
      currentReferenceCode = generateReferenceCode();

      // Generate PDF content
      generatePDF();

      // Show reference code popup after PDF download starts
      referenceCodeText.textContent = currentReferenceCode;
      refCodePopup.style.display = 'flex';

      // Enable "Send Telegram" button now
      sendTelegramBtn.disabled = false;

      // Disable Submit button and form after submit
      generatePdfBtn.disabled = true;
      addHeir.disabled = true;
      // Disable all inputs
      [...document.querySelectorAll('#warishForm input, #warishForm button')].forEach(el => {
        if(el !== sendTelegramBtn && el !== contactTelegramBtn) el.disabled = true;
      });
    });

    // Generate PDF function
    function generatePDF() {
      // Prepare content for PDF
      const pdfContent = document.createElement('div');
      pdfContent.id = 'pdfContent';

      // Form values
      const formName = document.getElementById('formName').value.trim();
      const formNumber = document.getElementById('formNumber').value.trim();
      const deceasedName = document.getElementById('deceasedName').value.trim();
      const fatherName = document.getElementById('fatherName').value.trim();
      const mohalla = document.getElementById('mohalla').value.trim();
      const ward = document.getElementById('ward').value.trim();
      const postOffice = document.getElementById('postOffice').value.trim();
      const thana = document.getElementById('thana').value.trim();
      const district = document.getElementById('district').value.trim();

      let html = `
        <h1>‡¶ì‡ßü‡¶æ‡¶∞‡¶ø‡¶∂‡¶® ‡¶∏‡¶®‡¶¶</h1>
        <p><strong>‡¶´‡¶∞‡ßç‡¶Æ ‡¶®‡¶æ‡¶Æ:</strong> ${formName || '‚Äî'}</p>
        <p><strong>‡¶´‡¶∞‡ßç‡¶Æ ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞:</strong> ${formNumber || '‚Äî'}</p>
        <h3>‡¶Æ‡ßÉ‡¶§ ‡¶¨‡ßç‡¶Ø‡¶ï‡ßç‡¶§‡¶ø‡¶∞ ‡¶§‡¶•‡ßç‡¶Ø</h3>
        <p><strong>‡¶®‡¶æ‡¶Æ:</strong> ${deceasedName}</p>
        <p><strong>‡¶™‡¶ø‡¶§‡¶æ/‡¶∏‡ßç‡¶¨‡¶æ‡¶Æ‡ßÄ:</strong> ${fatherName}</p>
        <p><strong>‡¶Æ‡¶π‡¶≤‡ßç‡¶≤‡¶æ:</strong> ${mohalla}</p>
        <p><strong>‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶° ‡¶®‡¶Ç:</strong> ${ward}</p>
        <p><strong>‡¶°‡¶æ‡¶ï‡¶ò‡¶∞:</strong> ${postOffice}</p>
        <p><strong>‡¶â‡¶™‡¶ú‡ßá‡¶≤‡¶æ/‡¶•‡¶æ‡¶®‡¶æ:</strong> ${thana}</p>
        <p><strong>‡¶ú‡ßá‡¶≤‡¶æ:</strong> ${district}</p>
        <h3>‡¶ì‡ßü‡¶æ‡¶∞‡¶ø‡¶∂‡¶¶‡ßá‡¶∞ ‡¶§‡¶æ‡¶≤‡¶ø‡¶ï‡¶æ</h3>
        <table>
          <thead>
            <tr>
              <th>‡¶ï‡ßç‡¶∞‡¶Æ‡¶ø‡¶ï</th><th>‡¶®‡¶æ‡¶Æ</th><th>‡¶¨‡¶Ø‡¶º‡¶∏</th><th>‡¶∏‡¶Æ‡ßç‡¶™‡¶∞‡ßç‡¶ï</th><th>‡¶Æ‡¶®‡ßç‡¶§‡¶¨‡ßç‡¶Ø</th>
            </tr>
          </thead>
          <tbody>
      `;

      const heirsBody = document.getElementById('heirsBody');
      const rows = heirsBody.querySelectorAll('tr');
      rows.forEach((row, idx) => {
        const heirName = row.querySelector('input[name="heirName[]"]').value.trim() || '‚Äî';
        const age = row.querySelector('input[name="age[]"]').value.trim() || '‚Äî';
        const relation = row.querySelector('input[name="relation[]"]').value.trim() || '‚Äî';
        const comment = row.querySelector('input[name="comment[]"]').value.trim() || '‚Äî';

        html += `<tr>
          <td>${toBanglaNumber(idx + 1)}</td>
          <td>${heirName}</td>
          <td>${age}</td>
          <td>${relation}</td>
          <td>${comment}</td>
        </tr>`;
      });

      html += `</tbody></table>`;
      html += `<p><strong>‡¶∞‡ßá‡¶´‡¶æ‡¶∞‡ßá‡¶®‡ßç‡¶∏ ‡¶ï‡ßã‡¶°:</strong> ${currentReferenceCode}</p>`;

      pdfContent.innerHTML = html;

      const opt = {
        margin:       0.5,
        filename:     `‡¶ì‡ßü‡¶æ‡¶∞‡¶ø‡¶∂‡¶®_‡¶∏‡¶®‡¶¶_${currentReferenceCode}.pdf`,
        image:        { type: 'jpeg', quality: 0.98 },
        html2canvas:  { scale: 2 },
        jsPDF:        { unit: 'in', format: 'a4', orientation: 'portrait' }
      };

      html2pdf().set(opt).from(pdfContent).save();
    }

    // Send data to Telegram
    const sendTelegramBtn = document.getElementById('sendTelegramBtn');

    sendTelegramBtn.addEventListener('click', () => {
      sendTelegramBtn.disabled = true;
      sendTelegramBtn.textContent = '‡¶™‡¶æ‡¶†‡¶æ‡¶®‡ßã ‡¶π‡¶ö‡ßç‡¶õ‡ßá...';

      // Collect form data for Telegram message
      const formName = document.getElementById('formName').value.trim();
      const formNumber = document.getElementById('formNumber').value.trim();
      const deceasedName = document.getElementById('deceasedName').value.trim();
      const fatherName = document.getElementById('fatherName').value.trim();
      const mohalla = document.getElementById('mohalla').value.trim();
      const ward = document.getElementById('ward').value.trim();
      const postOffice = document.getElementById('postOffice').value.trim();
      const thana = document.getElementById('thana').value.trim();
      const district = document.getElementById('district').value.trim();

      let message = `üìù *‡¶ì‡ßü‡¶æ‡¶∞‡¶ø‡¶∂‡¶® ‡¶∏‡¶®‡¶¶ ‡¶´‡¶∞‡¶Æ ‡¶§‡¶•‡ßç‡¶Ø*\n\n`;
      message += `*‡¶´‡¶∞‡ßç‡¶Æ ‡¶®‡¶æ‡¶Æ:* ${formName || '‚Äî'}\n`;
      message += `*‡¶´‡¶∞‡ßç‡¶Æ ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞:* ${formNumber || '‚Äî'}\n\n`;

      message += `*‡¶Æ‡ßÉ‡¶§ ‡¶¨‡ßç‡¶Ø‡¶ï‡ßç‡¶§‡¶ø‡¶∞ ‡¶§‡¶•‡ßç‡¶Ø:*\n`;
      message += `‡¶®‡¶æ‡¶Æ: ${deceasedName}\n`;
      message += `‡¶™‡¶ø‡¶§‡¶æ/‡¶∏‡ßç‡¶¨‡¶æ‡¶Æ‡ßÄ: ${fatherName}\n`;
      message += `‡¶Æ‡¶π‡¶≤‡ßç‡¶≤‡¶æ: ${mohalla}\n`;
      message += `‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶° ‡¶®‡¶Ç: ${ward}\n`;
      message += `‡¶°‡¶æ‡¶ï‡¶ò‡¶∞: ${postOffice}\n`;
      message += `‡¶â‡¶™‡¶ú‡ßá‡¶≤‡¶æ/‡¶•‡¶æ‡¶®‡¶æ: ${thana}\n`;
      message += `‡¶ú‡ßá‡¶≤‡¶æ: ${district}\n\n`;

      message += `*‡¶ì‡ßü‡¶æ‡¶∞‡¶ø‡¶∂‡¶¶‡ßá‡¶∞ ‡¶§‡¶æ‡¶≤‡¶ø‡¶ï‡¶æ:*\n`;

      const heirsBody = document.getElementById('heirsBody');
      const rows = heirsBody.querySelectorAll('tr');
      rows.forEach((row, idx) => {
        const heirName = row.querySelector('input[name="heirName[]"]').value.trim() || '‚Äî';
        const age = row.querySelector('input[name="age[]"]').value.trim() || '‚Äî';
        const relation = row.querySelector('input[name="relation[]"]').value.trim() || '‚Äî';
        const comment = row.querySelector('input[name="comment[]"]').value.trim() || '‚Äî';

        message += `${toBanglaNumber(idx + 1)}. ‡¶®‡¶æ‡¶Æ: ${heirName}, ‡¶¨‡¶Ø‡¶º‡¶∏: ${age}, ‡¶∏‡¶Æ‡ßç‡¶™‡¶∞‡ßç‡¶ï: ${relation}`;
        if(comment !== '‚Äî') message += `, ‡¶Æ‡¶®‡ßç‡¶§‡¶¨‡ßç‡¶Ø: ${comment}`;
        message += `\n`;
      });

      message += `\n‡¶∞‡ßá‡¶´‡¶æ‡¶∞‡ßá‡¶®‡ßç‡¶∏ ‡¶ï‡ßã‡¶°: ${currentReferenceCode}`;

      // Send message via Telegram Bot API (use fetch)
      const url = `https://api.telegram.org/bot${TELEGRAM_BOT_TOKEN}/sendMessage`;

      fetch(url, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          chat_id: TELEGRAM_CHAT_ID,
          text: message,
          parse_mode: 'Markdown'
        })
      })
      .then(res => res.json())
      .then(data => {
        if (data.ok) {
          alert('‡¶§‡¶•‡ßç‡¶Ø ‡¶∏‡¶´‡¶≤‡¶≠‡¶æ‡¶¨‡ßá ‡¶ü‡ßá‡¶≤‡¶ø‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ‡ßá ‡¶™‡¶æ‡¶†‡¶æ‡¶®‡ßã ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá‡•§');
          sendTelegramBtn.disabled = true;
          sendTelegramBtn.textContent = '‡¶ü‡ßá‡¶≤‡¶ø‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ‡ßá ‡¶™‡¶æ‡¶†‡¶æ‡¶®‡ßã ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá';
        } else {
          alert('‡¶ü‡ßá‡¶≤‡¶ø‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ‡ßá ‡¶™‡¶æ‡¶†‡¶æ‡¶§‡ßá ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá, ‡¶™‡¶∞‡ßá ‡¶Ü‡¶¨‡¶æ‡¶∞ ‡¶ö‡ßá‡¶∑‡ßç‡¶ü‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§');
          sendTelegramBtn.disabled = false;
          sendTelegramBtn.textContent = '‡¶ü‡ßá‡¶≤‡¶ø‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ‡ßá‡¶∞ ‡¶§‡¶•‡ßç‡¶Ø ‡¶™‡¶æ‡¶†‡¶æ‡¶®';
        }
      })
      .catch(() => {
        alert('‡¶ü‡ßá‡¶≤‡¶ø‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ‡ßá ‡¶™‡¶æ‡¶†‡¶æ‡¶§‡ßá ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá, ‡¶á‡¶®‡ßç‡¶ü‡¶æ‡¶∞‡¶®‡ßá‡¶ü ‡¶ï‡¶æ‡¶®‡ßá‡¶ï‡¶∂‡¶® ‡¶ö‡ßá‡¶ï ‡¶ï‡¶∞‡ßÅ‡¶®‡•§');
        sendTelegramBtn.disabled = false;
        sendTelegramBtn.textContent = '‡¶ü‡ßá‡¶≤‡¶ø‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ‡ßá‡¶∞ ‡¶§‡¶•‡ßç‡¶Ø ‡¶™‡¶æ‡¶†‡¶æ‡¶®';
      });
    });

    // Telegram contact popup logic
    const contactTelegramBtn = document.getElementById('contactTelegramBtn');

    contactTelegramBtn.addEventListener('click', () => {
      telegramContactPopup.style.display = 'flex';
      contactRefCodeInput.value = '';
      contactErrorMsg.style.display = 'none';
      refCodeValidIcon.textContent = '‚ùå';
      refCodeValidIcon.style.color = 'red';
      contactConfirmBtn.disabled = true;
      contactRefCodeInput.focus();
    });

    contactCancelBtn.addEventListener('click', () => {
      telegramContactPopup.style.display = 'none';
    });

    // Validate reference code input realtime
    contactRefCodeInput.addEventListener('input', () => {
      const val = contactRefCodeInput.value.trim().toUpperCase();
      if (val === currentReferenceCode) {
        refCodeValidIcon.textContent = '‚úîÔ∏è';
        refCodeValidIcon.style.color = 'green';
        contactConfirmBtn.disabled = false;
        contactErrorMsg.style.display = 'none';
        contactRefCodeInput.classList.remove('invalid');
        contactRefCodeInput.classList.add('valid');
      } else {
        refCodeValidIcon.textContent = '‚ùå';
        refCodeValidIcon.style.color = 'red';
        contactConfirmBtn.disabled = true;
        contactErrorMsg.style.display = 'block';
        contactRefCodeInput.classList.remove('valid');
        contactRefCodeInput.classList.add('invalid');
      }
    });

    // Contact confirm button (redirect to Telegram)
    contactConfirmBtn.addEventListener('click', () => {
      if(contactRefCodeInput.value.trim().toUpperCase() === currentReferenceCode){
        // open telegram chat with username
        const tgUrl = `https://t.me/${TELEGRAM_USERNAME}?text=‡¶∞‡ßá‡¶´‡¶æ‡¶∞‡ßá‡¶®‡ßç‡¶∏%20‡¶ï‡ßã‡¶°%20‡¶π‡¶≤‡ßã%20${currentReferenceCode}%20‡¶è‡¶¨‡¶Ç%20‡¶Ü‡¶∞‡ßã%20‡¶§‡¶•‡ßç‡¶Ø%20‡¶Ü‡¶™‡¶®‡¶æ‡¶∞%20‡¶´‡¶∞‡ßç‡¶Æ‡ßá%20‡¶Ø‡¶•‡¶æ‡¶Ø‡¶•%20‡¶¶‡ßá‡¶ì‡¶Ø‡¶º‡¶æ%20‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá‡•§`;
        window.open(tgUrl, '_blank');
        telegramContactPopup.style.display = 'none';
      } else {
        contactErrorMsg.style.display = 'block';
      }
    });

    // Initialize on page load
    window.onload = () => {
      initHeirsTable();
    }
  </script>
</body>

</html>

